<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>LTOD</title>
        <script type="text/javascript" src="../d3/d3.v3.js"></script>
    </head>
    <body>
    	<p><a href="http://www.dashingd3js.com/using-the-svg-coordinate-space">http://www.dashingd3js.com/using-the-svg-coordinate-space</a></p>
        <p>http://bl.ocks.org/mbostock/1021841</p>
        <script type="text/javascript">
		
		var w = screen.width-100;
		var h = 500;
		
		var triangleData = 		[{"x":10, "y":0},
							{"x":20, "y":20},
							{"x":0, "y":20}];
			
		var svgContainer = d3.select("body").append("svg")
						.attr("width", w) //browser size
						.attr("height",h)
						.style("border","10px solid grey")
						.style("background-color","grey");

		var triangle = d3.svg.line(triangleData)
								.x(function (d){return d.x})
								.y(function (d){return d.y})
								.interpolate("linear");

		var maxWidth = screen.width/2;
		var maxHeight = screen.height/2;
		var rangedX= d3.range(0,maxWidth,20); //start, stop, step... this is an array
		var rangedY = d3.range(0,maxHeight,20); // this is also an array
		
		// maybe i can create an array of arrays
		// tutorial here: http://alignedleft.com/tutorials/d3/making-a-scatterplot 
		// a better answer here: http://www.javascripter.net/faq/twodimensional.htm
		
		
		//COMPLETE ARRAY of OBJECTS
		var newRange = new Array();
		
		for(var i=0; i<rangedY.length; i++){
			var tempArray = new Object();
			for(var j=0; j<rangedX.length; j++){
				tempArray = {	x: rangedX[j], 
								y: rangedY[i]};
				newRange.push(tempArray);
			}
		};
		console.log(newRange[2]);
		var currentHover;
		var currentX;
		var currentY;
		var redX;
		var redY;
		var redSelectionIndex;
		
		var force = d3.layout.force()
			.nodes(newRange)
			.links([])
			.size([w, h])
			.theta(100)
			.charge(0);

		force.on("tick", function(d,i) {
			var root = newRange[redSelectionIndex];
			root.fixed = true; // added this line to fix the red triangle

	//	root.radius = 100;
			svgContainer.selectAll("path")  	
						.attr("transform", function(d,i) { 
								return "translate(" + d.x + "," + d.y + ")"; 
			});
			force.start();
			
			
	
		});
		var myVar =setInterval(function(){myTimer()},1000);
	
		function myTimer(){
			console.log("hello");
			force.charge(-1);
			myStopFunction();
		}
		function myStopFunction(){
			clearInterval(myVar);
			}

	

		var triangleAdd = svgContainer.selectAll("path")
					.data(newRange)
					.enter()
					.append("path")
					.attr("class","node")
					.attr("d", triangle(triangleData))
				//	.attr("cx",function(d){return d.x;})
				//	.attr("cy",function(d){return d.y;})
					.attr("transform", function(d){ //console.log(d + "," + rangedY[i]);
													return "translate(" + d.x + ","+ d.y +")" }) //this is key!!
					.attr("fill","lightskyblue")
					.on("mouseover", function(d,i){
						currentHover = d3.select(this);
						currentX= d.x;
						currentY = d.y;
						console.log(i);
						console.log(d.x);
						currentHover.style("fill", "dodgerblue");
					})
					.on("mouseout", function(d,i){
						if (i != redSelectionIndex){
							currentHover.style("fill","lightskyblue");
						} else{}
					})
					.on("click",function(d,i){
						if (currentHover = d3.select(this)){
							redSelectionIndex = i;
							redX = currentX;
							redY = currentY;
							currentHover.style("fill","firebrick");
							console.log("The exploder will be "+ redSelectionIndex);
							force.size([redX*2, redY*2]);

							//newRange.splice(redSelectionIndex,1); console.log("yippee");
							force.start();
	//						for (var i = 0; i < 10; ++i) {force.tick();};
	//						force.stop();

						};
						newRange.forEach(function(o, i) {
							console.log("other");
							o.x += (Math.random() - .5) * 40;
							o.y += (Math.random() - .5) * 40;
						  });
						  force.resume();
					});


	
		</script>
    </body>
</html>     